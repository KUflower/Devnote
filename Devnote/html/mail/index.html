<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Devnote</title>

		<!-- BEGIN META -->
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta name="keywords" content="your,keywords">
		<meta name="description" content="Short explanation about this website">
		<!-- END META -->

		<!-- BEGIN STYLESHEETS -->
		<link href='http://fonts.googleapis.com/css?family=Roboto:300italic,400italic,300,400,500,700,900' rel='stylesheet' type='text/css'/>
		<link type="text/css" rel="stylesheet" href="../../assets/css/theme-1/bootstrap.css?1422792965" />
		<link type="text/css" rel="stylesheet" href="../../assets/css/theme-1/materialadmin.css?1425466319" />
		<link type="text/css" rel="stylesheet" href="../../assets/css/theme-1/font-awesome.min.css?1422529194" />
		<link type="text/css" rel="stylesheet" href="../../assets/css/theme-1/material-design-iconic-font.min.css?1421434286" />
		<link type="text/css" rel="stylesheet" href="../../assets/css/theme-1/libs/summernote/summernote.css?1425218701" />
		<!-- END STYLESHEETS -->

		<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
		<!--[if lt IE 9]>
		<script type="text/javascript" src="../../assets/js/libs/utils/html5shiv.js?1403934957"></script>
		<script type="text/javascript" src="../../assets/js/libs/utils/respond.min.js?1403934956"></script>
		<![endif]-->
		<style>
			#select-notebook{
				color: rgba(49, 51, 53, 0.6);
				font-size:10pt;
			}
			#select-language{
				font-size:10pt;
				color: rgba(49, 51, 53, 0.6);
				float: right;
			}
			#note-title {
				font-size: 14pt;
			}
			#note-func li{
				padding:0px;
				float:right;
			}
		</style>
	</head>
	<body class="menubar-hoverable header-fixed menubar-first full-content ">

		<!-- BEGIN HEADER-->
		<header id="header" >
			<div class="headerbar">
				<!-- Brand and toggle get grouped for better mobile display -->
				<div class="headerbar-left">
					<ul class="header-nav header-nav-options">
						<li class="header-nav-brand" >
							<div class="brand-holder">
								<a href="../../html/mail/index.html">
									<span class="text-lg text-bold text-primary">DEVNOTE</span>
								</a>
							</div>
						</li>
						<li>
							<a class="btn btn-icon-toggle menubar-toggle" data-toggle="menubar" href="javascript:void(0);">
								<i class="fa fa-bars"></i>
							</a>
						</li>
					</ul>
				</div>
				<!-- Collect the nav links, forms, and other content for toggling -->
				<div class="headerbar-right">
					<ul class="header-nav header-nav-options">
						<li>
							<!-- Search form -->
							<form class="navbar-search" role="search">
								<div class="form-group">
									<input type="text" class="form-control" name="headerSearch" placeholder="Enter your keyword">
								</div>
								<button type="submit" class="btn btn-icon-toggle ink-reaction"><i class="fa fa-search"></i></button>
							</form>
						</li>
					</ul><!--end .header-nav-options -->

				</div><!--end #header-navbar-collapse -->
			</div>
		</header>
		<!-- END HEADER-->

		<!-- BEGIN BASE-->
		<div id="base">

			<!-- BEGIN OFFCANVAS LEFT -->
			<div class="offcanvas">
			</div><!--end .offcanvas-->
			<!-- END OFFCANVAS LEFT -->

			<!-- BEGIN CONTENT-->
			<div id="content">
				<section class="has-actions style-default-bright">


					<!-- BEGIN INBOX -->
					<div class="section-body" style="margin-top:20px;">
						<div class="row">

							<!-- BEGIN INBOX NAV -->
							<!-- <div class="col-sm-4 col-md-2 col-lg-2">
								<form class="navbar-search margin-bottom-xxl" role="search">
									<div class="form-group">
										<input type="text" class="form-control" name="contactSearch" placeholder="Enter your keyword">
									</div>
									<button type="submit" class="btn btn-icon-toggle ink-reaction"><i class="fa fa-search"></i></button>
								</form>
								<ul class="nav nav-pills nav-stacked nav-icon">
									<li><small>LIBRARY</small></li>
									<li class="active"><a href="#"><span class="glyphicon glyphicon-inbox"></span>Notes <small></small></a></li>
									<li><a href="#" class="text-default-light"> <i class="fa fa-dot-circle-o text-info"></i>Important</a></li>
									<li><a href="#" class="text-default-light">Recents</a></li>
									<li><a href="#" >All Notes</a></li>
									<li><a href="#"><span class="glyphicon glyphicon-trash"></span>Trash</a></li>
									<li><small>SHARED NOTESBOOKS</small></li>
									<li><small>NOTEBOOKS</small></li>
									<li><a href="#" class="text-default-light">Notebook List</a></li>
									</a></li>
								</ul>
							</div> --><!--end . -->
							<!-- END INBOX NAV -->

							<div class="col-sm-12 col-md-12 col-lg-12" >
								<div class="row">
									<!-- BEGIN INBOX EMAIL LIST -->
									<div class="col-md-3 col-lg-3 height-6 scroll-sm">

										<div class="form-group"  >
											<select id="select-notebook" class="form-control" onchange="showselected()">
											<option>모든 노트</option>
											<script>
												var filesystem = require('fs');
												var dir = __dirname+'/devfolder/';
												filesystem.readdirSync(dir).forEach(function(file){
													file = dir+'/'+file;
													var stat = filesystem.statSync(file);
													if (stat && stat.isDirectory()){
														var filename = file.replace(/^.*[\\\/]/, '');
														document.write("<option>"+filename+"</option>");
													}
												});
												// 모든 노트일 때
												var x = document.getElementById("select-notebook").value;
												console.log(x);
												if (x == "모든 노트"){
													function defaultselection(){
														window.onload=function(){
															document.getElementById("notelist").innerHTML = "";
															var filesystem = require('fs');
															var dir = __dirname+'/devfolder/';
															filesystem.readdirSync(dir).forEach(function(file){
																file = dir+'/'+file;
																var stat = filesystem.statSync(file);
																if (stat && stat.isDirectory()){
																	var filename = file.replace(/^.*[\\\/]/, '');
																	var dir2 = dir+filename+'/';
																	filesystem.readdirSync(dir2).forEach(function(file){
																		file = dir2+'/'+file;
																		stat = filesystem.statSync(file);
																		var filename2 = file.replace(/^.*[\\\/]/, '');
																		if (filename2 != '.DS_Store'){
																			document.getElementById("notelist").innerHTML+="<a href='#' class='list-group-item'> <h5>Notebook</h5> <h4>"+filename2+"</h4> <p class = 'hidden-xs hidden-sm'>Summary</p> <div class = 'stick-top-right small-padding text-default-light text-sm'>10:30pm</div></a>";
																		}
																	});
																}
															});
														}
													}
													defaultselection();
												}
											</script>
										</select>
									</div>
										<div id = "notelist" class="list-group list-email list-gray">
										<script>
										function showselected() {
											var x = document.getElementById("select-notebook").value;
											if(x == "모든 노트") {
												function defaultselection(){
													document.getElementById("notelist").innerHTML = "";
													var filesystem = require('fs');
													var dir = __dirname+'/devfolder/';
													filesystem.readdirSync(dir).forEach(function(file){
														file = dir+'/'+file;
														var stat = filesystem.statSync(file);
														if (stat && stat.isDirectory()){
															var filename = file.replace(/^.*[\\\/]/, '');
															var dir2 = dir+filename+'/';
																filesystem.readdirSync(dir2).forEach(function(file){
																	file = dir2+'/'+file;
																	stat = filesystem.statSync(file);
																	var filename2 = file.replace(/^.*[\\\/]/, '');
																	if (filename2 != '.DS_Store'){
																		document.getElementById("notelist").innerHTML+="<a href='#' class='list-group-item'> <h5>Notebook</h5> <h4>"+filename2+"</h4> <p class = 'hidden-xs hidden-sm'>Summary</p> <div class = 'stick-top-right small-padding text-default-light text-sm'>10:30pm</div></a>";
																		}
																	});
																}
															});
													}
												defaultselection();
											}
											else{
												dir = __dirname+'/devfolder/'+x+'/';
												document.getElementById("notelist").innerHTML = "";
												filesystem.readdirSync(dir).forEach(function(file){
													file = dir+'/'+file;
													stat = filesystem.statSync(file);
													filename = file.replace(/^.*[\\\/]/, '');
													if (filename != '.DS_Store'){
														document.getElementById("notelist").innerHTML+="<a href='#' class='list-group-item'> <h5>Notebook</h5> <h4>"+filename+"</h4> <p class = 'hidden-xs hidden-sm'>Summary</p> <div class = 'stick-top-right small-padding text-default-light text-sm'>10:30pm</div></a>";
													}
												});
											}
										}
										</script>
										</div><!--end .list-group -->
									</div><!--end .col -->
									<!-- END INBOX EMAIL LIST -->

									<div class="col-sm-12 col-md-9 col-lg-5">
										<div class="form-group floating-label">
											<input type="text" class="form-control" id="note-title" placeholder="제목 없음" value="">
											<label></label>
										</div>
									</div>

									<div class="col-sm-12 col-md-9 col-lg-4" >
										<div class="form-group"  style="float:left; width:100px; padding-right:4px; margin:0px; ">
											<select id="select-language" name="select-language" class="form-control" style="float:left;">
												<option value="txt">Plain Text</option>
												<option value="c">C</option>
												<option value="cpp">C++</option>
												<option value="java">Java</option>
												<option value="js">JavaScript</option>
											</select>
										</div>

										<ul class="header-nav header-nav-options" id="note-func" style="float:left;">
											<li>
												<button class="btn btn-icon-toggle btn-default" id="btn-delete" title="delete">
													<i class="glyphicon glyphicon-trash"></i>
												</button>
											</li>
											<li>
												<button class="btn btn-icon-toggle btn-default" id="btn-download" title="download">
													<i class="md md-file-download"></i>
												</button>
											</li>
											<li>
												<button class="btn btn-icon-toggle btn-default" id="btn-save" title="save">
													<i class="md md-save"></i>
												</button>
											</li>
											<li>
												<button class="btn btn-icon-toggle btn-default" id="btn-preview" title="preview">
													<i class="md md-dvr"></i>
												</button>
											</li>
											<li>
												<button class="btn btn-icon-toggle btn-default" id="btn-markdown" title="markdown" >
													<i class="md md-assignment"></i>
												</button>
											</li>
											<li>
												<button class="btn btn-icon-toggle btn-default" id="btn-edit" title="edit">
													<i class="md md-border-color"></i>
												</button>
											</li>

										</ul><!--end .header-nav-options -->
									</div>

									<!-- BEGIN MAIL REPLY -->
									<div class="col-md-9 col-lg-9">


									<!--BEGIN Markdown editor -->
									<iframe id='markdown-editor' src="./markdown-editor.html" width = "100%" height="600" frameBorder="0"></iframe>
									<!--END Markdown editor -->

									</div><!--end .col -->

									<!-- BEGIN MAIL REPLY -->
								</div><!--end .row -->
							</div><!--end .col -->
						</div><!--end .row -->
					</div><!--end .section-body -->
					<!-- END INBOX -->

					<!-- BEGIN SECTION ACTION -->
					<div class="section-action style-primary">
						<div class="section-action-row">
							<a class="btn ink-reaction btn-icon-toggle" href="#"><i class="fa fa-chevron-left"></i></a>
						</div>
						<div class="section-floating-action-row">
							<button class="btn ink-reaction btn-floating-action btn-lg btn-accent" href="#" onclick="createNote();">+</button>
						</div>
					</div>
					<!-- END SECTION ACTION -->

				</section>
			</div><!--end #content-->
			<!-- END CONTENT -->

			<!-- BEGIN MENUBAR-->
			<div id="menubar" class="menubar-inverse ">
				<div class="menubar-fixed-panel">
					<div>
						<a class="btn btn-icon-toggle btn-default menubar-toggle" data-toggle="menubar" href="javascript:void(0);">
							<i class="fa fa-bars"></i>
						</a>
					</div>
					<div class="expanded">
						<a href="../../html/mail/index.html">
							<span class="text-lg text-bold text-primary ">DEVNOTE</span>
						</a>
					</div>
				</div>
				<div class="menubar-scroll-panel">

					<ul id="main-menu" class="gui-controls">

						<!-- BEGIN DASHBOARD -->
						<li>
							<a href="../../html/mail/index.html" >
								<div class="gui-icon"><i class="md md-home"></i></div>
								<span class="title">Dashboard</span>
							</a>
						</li><!--end /menu-li -->
						<!-- END DASHBOARD -->

						<!-- BEGIN EMAIL -->
						<li class="gui-folder">
							<a>
								<div class="gui-icon"><span class="glyphicon glyphicon-list-alt"></span></div>
								<span class="title">Notes</span>
							</a>
							<!--start submenu -->
							<ul>
								<li><a href="#" class="active"><span class="title">Notes</span></a></li>
								<li><a href="#" ><span class="title">Recent</span></a></li>
								<li><a href="#" ><span class="title">Important</span></a></li>
								<li><a href="#" ><span class="title">Trash</span></a></li>
							</ul><!--end /submenu -->
						</li><!--end /menu-li -->
						<!-- END EMAIL -->


						<!-- BEGIN LEVELS -->
						<li class="gui-folder">
							<a>
								<div class="gui-icon"><i class="fa fa-folder-open fa-fw"></i></div>
								<span class="title">Folders</span>
							</a>
							<!--start submenu -->
							<ul>
								<li><a href="#"><span class="title">Item 1</span></a></li>
								<li><a href="#"><span class="title">Item 1</span></a></li>
								<li class="gui-folder">
									<a href="javascript:void(0);">
										<span class="title">Open level 2</span>
									</a>
									<!--start submenu -->
									<ul>
										<li><a href="#"><span class="title">Item 2</span></a></li>
										<li class="gui-folder">
											<a href="javascript:void(0);">
												<span class="title">Open level 3</span>
											</a>
											<!--start submenu -->
											<ul>
												<li><a href="#"><span class="title">Item 3</span></a></li>
												<li><a href="#"><span class="title">Item 3</span></a></li>
												<li class="gui-folder">
													<a href="javascript:void(0);">
														<span class="title">Open level 4</span>
													</a>
													<!--start submenu -->
													<ul>
														<li><a href="#"><span class="title">Item 4</span></a></li>
														<li class="gui-folder">
															<a href="javascript:void(0);">
																<span class="title">Open level 5</span>
															</a>
															<!--start submenu -->
															<ul>
																<li><a href="#"><span class="title">Item 5</span></a></li>
																<li><a href="#"><span class="title">Item 5</span></a></li>
															</ul><!--end /submenu -->
														</li><!--end /submenu-li -->
													</ul><!--end /submenu -->
												</li><!--end /submenu-li -->
											</ul><!--end /submenu -->
										</li><!--end /submenu-li -->
									</ul><!--end /submenu -->
								</li><!--end /submenu-li -->
							</ul><!--end /submenu -->
						</li><!--end /menu-li -->
						<!-- END LEVELS -->

					</ul><!--end .main-menu -->
					<!-- END MAIN MENU -->

				</div><!--end .menubar-scroll-panel-->
			</div><!--end #menubar-->
			<!-- END MENUBAR -->

		</div><!--end #base-->
		<!-- END BASE -->
		<script>
  			window.jQuery = window.$ = require('jquery');
		</script>
		<script src="../../assets/js/libs/jquery/jquery-1.11.2.min.js"></script>
		<script src="../../assets/js/libs/jquery/jquery-migrate-1.2.1.min.js"></script>
		<script src="../../assets/js/libs/bootstrap/bootstrap.min.js"></script>
		<script src="../../assets/js/libs/spin.js/spin.min.js"></script>
		<script src="../../assets/js/libs/autosize/jquery.autosize.min.js"></script>
		<script src="../../assets/js/libs/nanoscroller/jquery.nanoscroller.min.js"></script>
		<script src="../../assets/js/libs/ckeditor/ckeditor.js"></script>
		<script src="../../assets/js/libs/ckeditor/adapters/jquery.js"></script>
		<script src="../../assets/js/libs/summernote/summernote.min.js"></script>
		<script src="../../assets/js/core/source/App.js"></script>
		<script src="../../assets/js/core/source/AppNavigation.js"></script>
		<script src="../../assets/js/core/source/AppOffcanvas.js"></script>
		<script src="../../assets/js/core/source/AppCard.js"></script>
		<script src="../../assets/js/core/source/AppForm.js"></script>
		<script src="../../assets/js/core/source/AppNavSearch.js"></script>
		<script src="../../assets/js/core/source/AppVendor.js"></script>
		<script src="../../assets/js/core/demo/Demo.js"></script>
		<script src="../../assets/js/core/demo/DemoFormEditors.js"></script>
		<script>
		function saveNote() {
			var notebook = document.getElementById("select-notebook").value;
			var dir = __dirname+'/devfolder/'+ notebook;
			var fs = require('fs');			//file write

			// 노트북 디렉토리 없을 시 폴더 생성
			if(!fs.existsSync(dir)){
			  fs.mkdirSync(dir);
			}

			var editor = document.getElementById("markdown-editor").contentWindow.editor;

			console.log(editor.getValue());


			var myData = {
			version:'1.0'
			};

			// 파일 이름에 Time stamp
			var dt = new Date();
			var utcDate = dt.toUTCString();
			if (!Date.now) {
					Date.now = function() { return new Date().getTime(); }
			}
			var timestamp = Math.floor(Date.now() / 1000);
			myData["title"] = document.getElementById('note-title').value;
			myData["created_time"] = timestamp;
			myData["updated_time"] = utcDate;
			myData["type"] = document.getElementById('select-language').value;
			myData["important"] = false;
			myData["trash"] = false;
			myData["content"] = editor.getValue();

//			var outputFilename = __dirname + '/devfolder/' + String(timestamp) + '.json';
			var outputFilename = dir + '/' + String(timestamp) + '.json';

			fs.writeFile(outputFilename, JSON.stringify(myData, null, 4), function(err) {
			if(err) {
			console.log(err);
			} else {
			console.log("JSON saved to " + outputFilename);
			}
			});

		}
		</script>
		<script>
		function createNote() {
			var notebook = document.getElementById("select-notebook").value;
			var dir = __dirname+'/devfolder/'+ notebook;
			var fs = require('fs');			//file write

			// 노트북 디렉토리 없을 시 폴더 생성
			if(!fs.existsSync(dir)){
			  fs.mkdirSync(dir);
			}

			var editor = document.getElementById("markdown-editor").contentWindow.editor;

			console.log(editor.getValue());


			var myData = {
			version:'1.0'
			};

			// 파일 이름에 Time stamp
			var dt = new Date();
			var utcDate = dt.toUTCString();
			if (!Date.now) {
					Date.now = function() { return new Date().getTime(); }
			}
			var timestamp = Math.floor(Date.now() / 1000);
			myData["title"] = document.getElementById('note-title').value;
			myData["created_time"] = timestamp;
			myData["updated_time"] = utcDate;
			myData["type"] = document.getElementById('select-language').value;
			myData["important"] = false;
			myData["trash"] = false;
			myData["content"] = editor.getValue();

//			var outputFilename = __dirname + '/devfolder/' + String(timestamp) + '.json';
			var outputFilename = dir + '/' + String(timestamp) + '.json';

			fs.writeFile(outputFilename, JSON.stringify(myData, null, 4), function(err) {
			if(err) {
			console.log(err);
			} else {
			console.log("JSON saved to " + outputFilename);
			showselected();
			}
			});

		}
		</script>

		<script type="text/javascript">
		$(document).ready(function(){
				$("#btn-edit").click(function(){
					document.getElementById('markdown-editor').contentWindow.document.getElementById("in").style.display = "inline";
					document.getElementById('markdown-editor').contentWindow.document.getElementById("in").style.width = "50%";
					document.getElementById('markdown-editor').contentWindow.document.getElementById("out").style.display = "inline";
					document.getElementById('markdown-editor').contentWindow.document.getElementById("out").style.left = "50%";
					document.getElementById('markdown-editor').contentWindow.document.getElementById("out").style.width = "auto";
				});
				$("#btn-markdown").click(function(){
					document.getElementById('markdown-editor').contentWindow.document.getElementById("out").style.display = "none";
					document.getElementById('markdown-editor').contentWindow.document.getElementById("in").style.display = "inline";
						document.getElementById('markdown-editor').contentWindow.document.getElementById("in").style.width = "100%";
				});
				$("#btn-preview").click(function(){
					document.getElementById('markdown-editor').contentWindow.document.getElementById("in").style.display = "none";
					document.getElementById('markdown-editor').contentWindow.document.getElementById("out").style.display = "inline";
					document.getElementById('markdown-editor').contentWindow.document.getElementById("out").style.left = "0%";
					document.getElementById('markdown-editor').contentWindow.document.getElementById("out").style.width = "auto";
				});
				$("#btn-save").click(function(){
					var notebook = document.getElementById("select-notebook").value;
					if(notebook != "모든 노트"){
						saveNote();
					}
					showselected();
				});
				$("#btn-download").click(function(){
					document.getElementById('markdown-editor').contentWindow.showMenu();
				});
				$("#btn-delete").click(function(){

				});
		});
		</script>

	</body>
</html>
